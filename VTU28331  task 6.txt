SQL> DECLARE
  2  total_age NUMBER := 0;
  3  num_players NUMBER := 0;
  4  avg_age NUMBER := 0;
  5  BEGIN
  6  FOR player_rec IN (SELECT Age FROM Player) LOOP
  7  total_age := total_age + player_rec.Age; -- Summing up the ages
  8  num_players := num_players + 1; -- Counting the number of players
  9  END LOOP;
 10  IF num_players > 0 THEN
 11  avg_age := total_age / num_players;
 12  END IF;
 13  DBMS_OUTPUT.PUT_LINE('Total Players: ' || num_players);
 14  DBMS_OUTPUT.PUT_LINE('Total Age: ' || total_age);
 15  DBMS_OUTPUT.PUT_LINE('Average Age: ' || avg_age);
 16  END;
 17  /

PL/SQL procedure successfully completed.


SQL> set serveroutput on;
SQL> DECLARE
 2      v_playerid  player.playerid%TYPE := 'p3';
  3      v_fname     player.fname%TYPE    := 'sai';
  4      v_lname     player.lname%TYPE    := 'S';
  5      v_age       player.age%TYPE      := 25;
  6      v_dob       player.dob%TYPE      := TO_DATE('24 14-APR-01', 'DD-MON-YYYY');
  7      v_role      player.role%TYPE     := 'WICKETKEEPER';
  8  BEGIN
  9      INSERT INTO player (playerid, fname, lname, age, dob, role)
 10      VALUES (v_playerid, v_fname, v_lname, v_age, v_dob, v_role);
 11
 12      DBMS_OUTPUT.PUT_LINE('Player record inserted successfully.');
 13  EXCEPTION
 14      WHEN OTHERS THEN
 15          DBMS_OUTPUT.PUT_LINE('Error inserting player: ' || SQLERRM);
 16  END;
 17  /


SQL> create table pmatch(playerid varchar2(25) references player(playerid), matchid varchar2(25) references match(matchid));

Table created.


SQL> CREATE OR REPLACE FUNCTION total_matches_played (
  2      p_playerid IN VARCHAR2
  3  )
  4  RETURN NUMBER
  5  IS
  6      v_count NUMBER;
  7  BEGIN
  8      SELECT COUNT(*)
  9      INTO v_count
 10      FROM pmatch
 11      WHERE playerid = p_playerid;
 12
 13      RETURN v_count;
 14
 15  EXCEPTION
 16      WHEN NO_DATA_FOUND THEN
 17          RETURN 0;
 18      WHEN OTHERS THEN
 19          RETURN -1;
 20  END total_matches_played;
 21  /


Function created.
